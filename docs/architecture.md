# Architecture 

So it's actually something like this:
```
             +-+-+-+-+-+ +-+                      +-+-+-+-+-+ +-+                 +-+-+-+-+-+ +-+               +-+-+-+-+-+ +-+                 +-+-+-+-+-+ +-+
             |S|T|A|G|E| |1|                      |S|T|A|G|E| |2|                 |S|T|A|G|E| |3|               |S|T|A|G|E| |4|                 |S|T|A|G|E| |5|
             +-+-+-+-+-+ +-+                      +-+-+-+-+-+ +-+                 +-+-+-+-+-+ +-+               +-+-+-+-+-+ +-+                 +-+-+-+-+-+ +-+
                                          │                             │                               │                             │
                                          │                             │                               │                             │
                                          │               ┌─────────────┼───────────────────────────────┼─────────────────────────────┼──────┐
                                                          ├──────────────────────────────────────────────────────────────────────────────────┤
                                                          │                                                   ┌─────────────────┐            │
                                          │               │             │       ┌────────────────┐      │     │   processor 1   │     │      │
                                          │               │             │       │     stream     │      │     │                 │     │      │
                                          │               │           event B1  │      ----      │  event B1  │    action 1 │   │     │      │
                                                          │         ┌─event B2─▶│  sourceID=100  │──event B2─▶│    action 2 │   │──┐         │
                                                          │         │           │  name=stderr   │            │       ...   │   │  │         │
                                          │               │         │   │       └────────────────┘      │     │    action K ▼   │  │  │      │
                                          │               │         │   │                               │     │                 │  │  │      │
                                          │               │         │   │       ┌────────────────┐      │     └─────────────────┘  │  │      │
                                                          │         │           │     stream     │                             event B1*     │
                                                          │         │           │      ----      │            ┌─────────────────┐  │         │
                                          │            event A*     │   │       │  sourceID=100  │      │     │   processor 2   │  │  │   event A*
                                          │            eve│t B1*    │   │       │  name=stdout   │      │     │                 │  │  │   eve│t B1*
┌────────────┐                            │               │         │   │       └────────────────┘      │     │    action 1 │   │  │  │      │
│  external  │                                            ▼         │                               ┌────────▶│    action 2 │   │──┤         │
│   system   │           ┌────────────┐           ┌──────────────┐  │           ┌────────────────┐  │         │       ...   │   │  │   ┌───────────┐        ┌──────────┐
│    ----    │           │            │   │       │   pipeline   │  │   │       │     stream     │  │   │     │    action K ▼   │  │  ││           │        │          │
│  source 1  │  []byte   │   input    │  []byte   │  controller  │  │   │       │      ----      │  │   │     │                 │  │  ││  output   │        │ external │
│  source 2  │─sourceID─▶│   plugin   │─sourceID─▶│     ----     │──┴──────────▶│  sourceID=256  │──┘   │     └─────────────────┘  └──▶│  plugin   │───────▶│  system  │
│    ...     │           │            │           │[]byte > event│              │  name=stdout   │                   ┌─────┐           │           │[]byte  │          │
│  source S  │           └────────────┘           └──────────────┘              └────────────────┘                   │ ... │           └───────────┘        └──────────┘
│            │                            │          ▲       ┃          │             ┌─────┐           │            └─────┘          │
└────────────┘                            │          ┃       ┃          │             │ ... │           │     ┌─────────────────┐     │
                                          │          ┃       ┃          │             └─────┘           │     │   processor P   │     │
                                                   fresh   stale                ┌────────────────┐            │                 │
                                                   event   event                │     stream     │            │    action 1 │   │
                                          │          ┃       ┃          │       │      ----      │      │     │    action 2 │   │     │
                                          │          ┃       ▼          │       │  sourceID=XXX  │      │     │       ...   │   │     │
                                          │       ┏━━━━━━━━━━━━━━┓      │       │    name=YYY    │      │     │    action K ▼   │     │
                                                  ┃  event pool  ┃              └────────────────┘            │                 │
                                                  ┃     ----     ┃                                            └─────────────────┘
                                          │       ┃   event 1    ┃      │                               │              │              │
                                          │       ┃   event 2    ┃◀─────┼───────────────────────────event B2*──────────┘              │
                                          │       ┃     ...      ┃      │                               │                             │
                                                  ┃   event N    ┃
                                                  ┗━━━━━━━━━━━━━━┛
                                          │                             │                               │                             │
                                          │                             │                               │                             │
                                          │                             │                               │                             │
```

TBF: explain this crazy picture.